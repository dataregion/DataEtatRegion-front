<!-- <iframe [src]="sanitizedUrl" width="100%" height="1150px"></iframe> -->

<div class="fr-grid-row fr-grid-row--gutters">
    <div class="fr-col-4">
        <div style="background-color: #FFF3FE; padding: 15px;">
            <p style="color: #A558A0; font-weight: bold;">Total des financements</p>
            @if (currentDashboardData()) {
                <h3 style="margin-bottom: 0px; text-align: center;">{{currentDashboardData()?.total_financements | currency: 'EUR':'symbol':'1.2-2':'fr-FR'}}</h3>
            } @else {
                <lib-spinner />
            }
        </div>
    </div>
    <div class="fr-col-4">
        <div style="background-color: #FFF3FE; padding: 15px;">
            <p style="color: #A558A0; font-weight: bold;">Nombre d'actions subventionnées</p>
            @if (currentDashboardData()) {
                <h3 style="margin-bottom: 0px; text-align: center;">{{currentDashboardData()?.total_actions}}</h3>
            } @else {
                <lib-spinner />
            }
        </div>
    </div>
    <div class="fr-col-4">
        <div style="background-color: #FFF3FE; padding: 15px;">
            <p style="color: #A558A0; font-weight: bold;">Nombre de porteur de projet</p>
            @if (currentDashboardData()) {
                <h3 style="margin-bottom: 0px; text-align: center;">{{currentDashboardData()?.total_porteurs}}</h3>
            } @else {
                <lib-spinner />
            }
        </div>
    </div>
    <div class="fr-col-12">
        <div style="background-color: #FFF3FE; padding: 15px;">
            <p style="color: #A558A0; font-weight: bold;">Répartition des financements par thématique</p>
            <div class="fr-griw-row">
                @if (currentDashboardData()) {
                    @if (isArrayFilled(currentDashboardData()?.pie_chart_themes)) {
                        <div class="fr-col-9 fr-col-offset-3">
                            <pie-chart
                                [labels]="currentDashboardData()?.pie_chart_themes?.labels"
                                [values]="currentDashboardData()?.pie_chart_themes?.values"
                                unit-tooltip='€'>
                            </pie-chart>
                        </div>
                    } @else {
                        <div class="fr-col-12">
                            <div class="fr-alert fr-alert--info">
                                <h6 class="fr-alert__title">Aucun résultat</h6>
                            </div>
                        </div>
                    }
                } @else {
                    <div class="fr-col-12">
                        <lib-spinner />
                    </div>
                }
            </div>
        </div>
    </div>
    <div class="fr-col-12">
        @if (selectedTab() === 0) {
            <div style="background-color: #FFF3FE; padding: 15px;">
                <p style="color: #A558A0; font-weight: bold;">Répartition des financements par type de porteur de projet</p>
                <div class="fr-griw-row">
                    @if (currentDashboardData()) {
                        @if (isArrayFilled(currentDashboardData()?.pie_chart_types_porteurs)) {
                            <div class="fr-col-9 fr-col-offset-3">
                                <pie-chart
                                    [labels]="currentDashboardData()?.pie_chart_types_porteurs?.labels"
                                    [values]="currentDashboardData()?.pie_chart_types_porteurs?.values"
                                    unit-tooltip='€'>
                                </pie-chart>
                            </div>
                        } @else {
                            <div class="fr-col-12">
                                <div class="fr-alert fr-alert--info">
                                    <h6 class="fr-alert__title">Aucun résultat</h6>
                                </div>
                            </div>
                        }
                    } @else {
                        <div class="fr-col-12">
                            <lib-spinner />
                        </div>
                    }
                </div>
            </div>
        } @else {
            <div style="background-color: #FFF3FE; padding: 15px;">
                <p style="color: #A558A0; font-weight: bold;">Représentation par financeur</p>
                <div class="fr-griw-row">
                    @if (currentDashboardData()) {
                        @if (isArrayFilled(currentDashboardData()?.bar_chart_financeurs)) {
                            <div class="fr-col-8 fr-col-offset-2">
                                <bar-chart
                                    [labels]="currentDashboardData()?.bar_chart_financeurs?.labels"
                                    [values]="currentDashboardData()?.bar_chart_financeurs?.values"
                                    unit-tooltip='€'>
                                </bar-chart>
                            </div>
                        } @else {
                            <div class="fr-col-12">
                                <div class="fr-alert fr-alert--info">
                                    <h6 class="fr-alert__title">Aucun résultat</h6>
                                </div>
                            </div>
                        }
                    } @else {
                        <div class="fr-col-12">
                            <lib-spinner />
                        </div>
                    }
                </div>
            </div>
        }
    </div>
    <div class="fr-col-12">
        <div style="background-color: #FFF3FE; padding: 15px;">
            <p style="color: #A558A0; font-weight: bold;">Evolution des financements par année</p>
            <div class="fr-griw-row">
                @if (currentDashboardData()) {
                    @if (isArrayFilled(currentDashboardData()?.line_chart_annees) && isArrayFilled(currentDashboardData()?.line_chart_annees)) {
                        <div class="fr-col-8 fr-col-offset-2">
                            <line-chart
                                [labels]="currentDashboardData()?.line_chart_annees?.labels"
                                [values]="currentDashboardData()?.line_chart_annees?.values"
                                >
                            </line-chart>
                        </div>
                    } @else {
                        <div class="fr-col-12">
                            <div class="fr-alert fr-alert--info">
                                <h6 class="fr-alert__title">Aucun résultat</h6>
                            </div>
                        </div>
                    }
                } @else {
                    <div class="fr-col-12">
                        <lib-spinner />
                    </div>
                }
            </div>
        </div>
    </div>
</div>