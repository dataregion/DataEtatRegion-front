<dialog #modalSauvegarde id="modalSauvegarde" class="fr-modal" aria-labelledby="modal-title" aria-modal="true">
  <div class="fr-container fr-container--fluid fr-container-sm">
    <div class="fr-grid-row fr-grid-row--center">
      <div class="fr-col-12 fr-col-md-6 fr-col-lg-4">
        <form [formGroup]="formPreference" (ngSubmit)="validate()" class="fr-modal__body">
          <div class="fr-modal__header">
            <button aria-controls="modalSauvegarde" title="Fermer" type="button"
              class="fr-btn--close fr-btn">Fermer</button>
          </div>
          <div class="fr-modal__content">
            <h2 id="modal-title" class="fr-modal__title">
              <span class="fr-icon-arrow-right-line fr-icon--lg" aria-hidden="true"></span>
              Sauvegarder la recherche
            </h2>
            
            <div class="fr-fieldset__element">
              <div class="fr-input-group" id="input-group-16">
                <input id="name" formControlName="name" type="text" class="fr-input" aria-describedby="input-0-messages" placeholder="Nom de votre recherche">
                <div class="fr-messages-group" id="name-messages" aria-live="polite">
                </div>
              </div>
            </div>
            <div class="fr-fieldset__element">
              <div class="fr-checkbox-group">
                <input id="shared" formControlName="shared" type="checkbox" aria-describedby="shared-messages">
                <label class="fr-label" for="shared">Partager la recherche</label>
                <div class="fr-messages-group" id="shared-messages" aria-live="polite">
                </div>
              </div>
            </div>
           
            @if (formPreference.controls.shared.value) {
              <dsfrx-autocomplete
                formControlName="users"
                placeholder="Rechercher un utilisateur (mail)"
                [multiple]="true"
                [minLength]="4"
                [loading]="loading"
                [delay]="500"
                [suggestions]="(suggestions$ | async) ?? []"
                (filterChange)="onSearchAsync($event)" />
            }
          </div>
          <div class="fr-modal__footer">
            <div class="fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left">
              <button type="submit" aria-controls="modalSauvegarde" class="fr-btn fr-icon-checkbox-circle-line fr-btn--icon-left">Valider</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</dialog>